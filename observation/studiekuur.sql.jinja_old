select 
    concat('STUDIE_', kuur.code) as observation_id	
    ,kuur.patnum as person_id
    ,'HIX_STUDIEMEDICATIE' as observation_concept_id
    ,cast(deel.startdt as DATE) as observation_date
    ,DATETIME(
        CAST(deel.startdt as DATE), 
        CASE
            WHEN REGEXP_CONTAINS(deel.starttd, r'^[0-9]{2}:[0-9]{2}:[0-9]{2}$') THEN PARSE_TIME('%H:%M:%S', deel.starttd)
            WHEN REGEXP_CONTAINS(deel.starttd, r'^[0-9]{2}:[0-9]{2}$') THEN PARSE_TIME('%H:%M', deel.starttd)
            ELSE TIME(0, 0, 0)
        END
    ) as observation_datetime      
    ,'ADMINISTRATION_RECORD' as observation_type_concept_id
    ,cast(null as float64) as value_as_number
    ,kuur.omschrijv as value_as_string
    ,cast(null as string) as value_as_concept_id 
    ,cast(null as string) as qualifier_concept_id
    ,cast(null as string) as unit_concept_id
    ,cast(null as string) as provider_id
    ,cast(null as string) as visit_occurrence_id
    ,cast(null as string) as visit_detail_id
    ,'HIX_STUDIEMEDICATIE' as observation_source_value
    ,cast(null as string) as observation_source_concept_id
    ,cast(null as string) as unit_source_value
    ,cast(null as string) as qualifier_source_value
    ,kuur.omschrijv as value_source_value
    ,cast(null as string) as observation_event_id
    ,cast(null as string) as obs_event_field_concept_id 
from {{project_id}}.{{dataset_id_raw}}.MEDICAT_KUUR kuur 
inner join {{project_id}}.{{dataset_id_raw}}.MEDICAT_KUURDEEL deel on kuur.CODE = deel.KUURCD
where omschrijv like '%ST %'